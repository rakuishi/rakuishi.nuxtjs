{
  "categories": [
    "iOS"
  ],
  "date": "2012-03-20T00:42:43.000Z",
  "draft": false,
  "slug": 2994,
  "title": "[iOS SDK] UITableViewCell の ImageView の横幅を統一する",
  "bodyContent": "現在、Music 内にあるアルバムタイトル・アーティスト名・アートワークを表示するアプリを作成して遊んでいます。\n\nで、標準アプリ Music のように、左に画像を設置しているのですが、なんだか横幅がばらばらに表示されてしまいます。\n\n![](/images/2012/03/2994_1.png)\n\nこの横幅を統一するために色々と調べましたのでメモします。\n\n## 方針\n\n最初は、- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 内で、画像の横幅を設定していたのですが、思ったように動作しませんでした。\n\nUITableViewCell をサブクラス化して、- (void) layoutSubviews クラス内に記述するとうまく動作するようです。\n\n## サブクラスの作成\n\n「File」→「New」→「File...」→「iOS」→「Objective-C class」を選択。\n\n![](/images/2012/03/2994_2.png)\n\n* Class: ImageSizeFixedCell\n* Subclass of: UITableViewCell\n\nと入力して、ファイルを作成します。その際、Targets にチェックが入っていることを確認しておきます。\n\nImageSizeFixedCell.m に以下のように記述。画像サイズは、各自変更する必要ありです。\n\n```\n#import \"ImageSizeFIxedCell.h\"\n#import <QuartzCore/QuartzCore.h>\n\n@implementation ImageSizeFIxedCell\n\n- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier\n{\n    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];\n    if (self) {\n        // Initialization code\n    }\n    return self;\n}\n\n- (void)setSelected:(BOOL)selected animated:(BOOL)animated\n{\n    [super setSelected:selected animated:animated];\n\n    // Configure the view for the selected state\n}\n\n- (void) layoutSubviews {\n    [super layoutSubviews];\n\n    float desiredWidth = 60;\n    float w=self.imageView.frame.size.width;\n    if (w>desiredWidth) {\n        float widthSub = w - desiredWidth;\n        self.imageView.frame = CGRectMake(self.imageView.frame.origin.x,self.imageView.frame.origin.y,desiredWidth,self.imageView.frame.size.height);\n        self.textLabel.frame = CGRectMake(self.textLabel.frame.origin.x-widthSub,self.textLabel.frame.origin.y,self.textLabel.frame.size.width+widthSub,self.textLabel.frame.size.height);\n        self.detailTextLabel.frame = CGRectMake(self.detailTextLabel.frame.origin.x-widthSub,self.detailTextLabel.frame.origin.y,self.detailTextLabel.frame.size.width+widthSub,self.detailTextLabel.frame.size.height);\n        self.imageView.contentMode = UIViewContentModeScaleAspectFit;\n    }\n}\n\n@end\n```\n\n## cellForRowAtIndexPath 内の記述を変更\n\n先ほど作成したサブクラスをインポートします。\n\n```\n#import \"ImageSizeFIxedCell.h\"\n```\n\nそして、cellForRowAtIndexPath 内の記述を変更していきます。\n\nここでは、Music 内にあるアルバムタイトル・アーティスト名・アートワークを表示するアプリをそのまま貼り付けています。\n\ncell.textLabel.text, cell.detailTextLabel.text, cell.imageView.image は、各自変更する必要ありです。\n\n```\n- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath\n{    \n    static NSString *CellIdentifier = @\"Cell\";\n    \n    // UITableViewCell → ImageSizeFIxedCell\n    ImageSizeFIxedCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];\n    if (cell == nil) {\n        cell = [[[ImageSizeFIxedCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] autorelease];\n    }\n    \n    MPMediaItemCollection *album = [self.albums objectAtIndex:indexPath.row];\n    MPMediaItem *representativeItem = [album representativeItem];\n    \n    cell.textLabel.text = [representativeItem valueForProperty: MPMediaItemPropertyAlbumTitle];\n    if ([cell.textLabel.text isEqualToString:@\"\"])\n        cell.textLabel.text = @\"Unknown Album\";\n    \n    cell.detailTextLabel.text = [representativeItem valueForProperty: MPMediaItemPropertyArtist];\n    if ([cell.detailTextLabel.text isEqualToString:@\"\"])\n        cell.detailTextLabel.text = @\"Unknown Artist\";\n    \n    MPMediaItemArtwork *artWork = [representativeItem valueForProperty: MPMediaItemPropertyArtwork];\n        \n    cell.imageView.image = [artWork imageWithSize: CGSizeMake(60.0f, 60.0f)];\n    \n    return cell;\n}\n```\n\nすると、以下のように綺麗に横幅が統一された状態で表示されます。\n\n![](/images/2012/03/2994_3.png)\n\n## Special Thanks !\n* [UITableViewCell の imageView を好きなところに置いたり、角丸にしたりする方法 « Zero4Racer PRO Developer's Blog](http://www.zero4racer.com/blog/359)\n* [iphone - How do I make UITableViewCell's ImageView a fixed size even when the image is smaller - Stack Overflow](http://stackoverflow.com/questions/2788028/how-do-i-make-uitableviewcells-imageview-a-fixed-size-even-when-the-image-is-sm)",
  "bodyHtml": "<p>現在、Music 内にあるアルバムタイトル・アーティスト名・アートワークを表示するアプリを作成して遊んでいます。</p>\n<p>で、標準アプリ Music のように、左に画像を設置しているのですが、なんだか横幅がばらばらに表示されてしまいます。</p>\n<p><img src=\"/images/2012/03/2994_1.png\" alt=\"\"></p>\n<p>この横幅を統一するために色々と調べましたのでメモします。</p>\n<h2>方針</h2>\n<p>最初は、- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 内で、画像の横幅を設定していたのですが、思ったように動作しませんでした。</p>\n<p>UITableViewCell をサブクラス化して、- (void) layoutSubviews クラス内に記述するとうまく動作するようです。</p>\n<h2>サブクラスの作成</h2>\n<p>「File」→「New」→「File...」→「iOS」→「Objective-C class」を選択。</p>\n<p><img src=\"/images/2012/03/2994_2.png\" alt=\"\"></p>\n<ul>\n<li>Class: ImageSizeFixedCell</li>\n<li>Subclass of: UITableViewCell</li>\n</ul>\n<p>と入力して、ファイルを作成します。その際、Targets にチェックが入っていることを確認しておきます。</p>\n<p>ImageSizeFixedCell.m に以下のように記述。画像サイズは、各自変更する必要ありです。</p>\n<pre><code>#import &quot;ImageSizeFIxedCell.h&quot;\n#import &lt;QuartzCore/QuartzCore.h&gt;\n\n@implementation ImageSizeFIxedCell\n\n- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier\n{\n    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];\n    if (self) {\n        // Initialization code\n    }\n    return self;\n}\n\n- (void)setSelected:(BOOL)selected animated:(BOOL)animated\n{\n    [super setSelected:selected animated:animated];\n\n    // Configure the view for the selected state\n}\n\n- (void) layoutSubviews {\n    [super layoutSubviews];\n\n    float desiredWidth = 60;\n    float w=self.imageView.frame.size.width;\n    if (w&gt;desiredWidth) {\n        float widthSub = w - desiredWidth;\n        self.imageView.frame = CGRectMake(self.imageView.frame.origin.x,self.imageView.frame.origin.y,desiredWidth,self.imageView.frame.size.height);\n        self.textLabel.frame = CGRectMake(self.textLabel.frame.origin.x-widthSub,self.textLabel.frame.origin.y,self.textLabel.frame.size.width+widthSub,self.textLabel.frame.size.height);\n        self.detailTextLabel.frame = CGRectMake(self.detailTextLabel.frame.origin.x-widthSub,self.detailTextLabel.frame.origin.y,self.detailTextLabel.frame.size.width+widthSub,self.detailTextLabel.frame.size.height);\n        self.imageView.contentMode = UIViewContentModeScaleAspectFit;\n    }\n}\n\n@end\n</code></pre>\n<h2>cellForRowAtIndexPath 内の記述を変更</h2>\n<p>先ほど作成したサブクラスをインポートします。</p>\n<pre><code>#import &quot;ImageSizeFIxedCell.h&quot;\n</code></pre>\n<p>そして、cellForRowAtIndexPath 内の記述を変更していきます。</p>\n<p>ここでは、Music 内にあるアルバムタイトル・アーティスト名・アートワークを表示するアプリをそのまま貼り付けています。</p>\n<p>cell.textLabel.text, cell.detailTextLabel.text, cell.imageView.image は、各自変更する必要ありです。</p>\n<pre><code>- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath\n{    \n    static NSString *CellIdentifier = @&quot;Cell&quot;;\n    \n    // UITableViewCell → ImageSizeFIxedCell\n    ImageSizeFIxedCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];\n    if (cell == nil) {\n        cell = [[[ImageSizeFIxedCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] autorelease];\n    }\n    \n    MPMediaItemCollection *album = [self.albums objectAtIndex:indexPath.row];\n    MPMediaItem *representativeItem = [album representativeItem];\n    \n    cell.textLabel.text = [representativeItem valueForProperty: MPMediaItemPropertyAlbumTitle];\n    if ([cell.textLabel.text isEqualToString:@&quot;&quot;])\n        cell.textLabel.text = @&quot;Unknown Album&quot;;\n    \n    cell.detailTextLabel.text = [representativeItem valueForProperty: MPMediaItemPropertyArtist];\n    if ([cell.detailTextLabel.text isEqualToString:@&quot;&quot;])\n        cell.detailTextLabel.text = @&quot;Unknown Artist&quot;;\n    \n    MPMediaItemArtwork *artWork = [representativeItem valueForProperty: MPMediaItemPropertyArtwork];\n        \n    cell.imageView.image = [artWork imageWithSize: CGSizeMake(60.0f, 60.0f)];\n    \n    return cell;\n}\n</code></pre>\n<p>すると、以下のように綺麗に横幅が統一された状態で表示されます。</p>\n<p><img src=\"/images/2012/03/2994_3.png\" alt=\"\"></p>\n<h2>Special Thanks !</h2>\n<ul>\n<li><a href=\"http://www.zero4racer.com/blog/359\">UITableViewCell の imageView を好きなところに置いたり、角丸にしたりする方法 « Zero4Racer PRO Developer's Blog</a></li>\n<li><a href=\"http://stackoverflow.com/questions/2788028/how-do-i-make-uitableviewcells-imageview-a-fixed-size-even-when-the-image-is-sm\">iphone - How do I make UITableViewCell's ImageView a fixed size even when the image is smaller - Stack Overflow</a></li>\n</ul>\n",
  "dir": "static/content/archives",
  "base": "2012-03-20-2994.json",
  "ext": ".json",
  "sourceBase": "2012-03-20-2994.md",
  "sourceExt": ".md"
}