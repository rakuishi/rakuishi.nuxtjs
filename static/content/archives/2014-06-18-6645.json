{
  "categories": [
    "Android"
  ],
  "date": "2014-06-17T20:14:11.000Z",
  "draft": false,
  "slug": 6645,
  "title": "[Android] FragmentPagerAdapter で Fragment のページ切り替えを実装する",
  "bodyContent": "`FragmentPageAdapter` を使って、スワイプによるページ切り替えを実装してみます。動作は iOS でいう `UIScrollView` の `pagingEnabled` を有効にした時の挙動と同じです。\n\n## 複数の Fragment をページ切り替えする\n\n## MyFragment.java\n\nまずは、ページ切り替えされるフラグメントを書きます。`Bundle` のデータを受け取り、その色を利用して背景色に設定します。\n\n```\npackage com.rakuishi.viewpagerfragment.sample;\n\nimport android.support.v4.app.Fragment;\nimport android.graphics.Color;\nimport android.os.Bundle;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\n\npublic class MyFragment extends Fragment {\n\n  @Override\n  public View onCreateView(LayoutInflater inflater, ViewGroup container,\n               Bundle savedInstanceState) {\n    // Inflate the layout for this fragment\n    View view = inflater.inflate(R.layout.fragment_my, container, false);\n    if (getArguments() != null && getArguments().containsKey(\"color\")) {\n      view.setBackgroundColor(Color.parseColor(getArguments().getString(\"color\")));\n    }\n    return view;\n  }\n}\n```\n\n## fragment_my.xml\n\n```\n<FrameLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  xmlns:tools=\"http://schemas.android.com/tools\"\n  android:layout_width=\"match_parent\"\n  android:layout_height=\"match_parent\"\n  tools:context=\"com.rakuishi.viewpagerfragment.sample.MyFragment\">\n\n</FrameLayout>\n```\n\n## MyFragmentPagerAdapter\n\n次に切り替えを担う `[FragmentPagerAdapter](http://developer.android.com/reference/android/support/v4/app/FragmentPagerAdapter.html)` を継承した `MyFragmentPagerAdapter` を作ります。`FragmentPagerAdapter` は、v4 support library の機能ですので、これを導入しておく必要があります。&rarr; [Android Studio で Support Library を導入する](http://rakuishi.com/archives/6609)\n\n`getCount()` と `getItem()` は必ず宣言する必要があり、その中でページ数とフラグメントを返します。\n\n```\npackage com.rakuishi.viewpagerfragment.sample;\n\n// FragmentPagerAdapter は、Support Library から使える\nimport android.os.Bundle;\nimport android.support.v4.app.Fragment;\nimport android.support.v4.app.FragmentManager;\nimport android.support.v4.app.FragmentPagerAdapter;\n\npublic class MyFragmentPagerAdapter extends FragmentPagerAdapter {\n\n  public MyFragmentPagerAdapter(FragmentManager fragmentManager) {\n    super(fragmentManager);\n  }\n\n  @Override\n  public int getCount() {\n    return 3;\n  }\n\n  @Override\n  public Fragment getItem(int position) {\n\n    String color = \"#000000\";\n    switch (position) {\n      case 0:\n        color = \"#FF0000\";\n        break;\n      case 1:\n        color = \"#00FF00\";\n        break;\n      case 2:\n        color = \"#0000FF\";\n        break;\n    }\n    Bundle bundle = new Bundle();\n    bundle.putString(\"color\", color);\n\n    Fragment fragment = new MyFragment();\n    fragment.setArguments(bundle);\n    return fragment;\n  }\n}\n```\n\n## MainActivity.java\n\nアクティビティから `ViewPager` に先程の `MyFragmentPagerAdapter` をセットすることでページ切り替えが実装できます。先に v4 support library を使っているため、これに対応する `FragmentActivity` を継承するのがポイントです。\n\n```\npackage com.rakuishi.viewpagerfragment.sample;\n\nimport android.os.Bundle;\nimport android.support.v4.app.FragmentActivity;\nimport android.support.v4.app.FragmentManager;\nimport android.support.v4.view.ViewPager;\n\npublic class MainActivity extends FragmentActivity {\n\n  @Override\n  protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_main);\n\n    // getSupportFragmentManager は, FragmentActivity で使える\n    FragmentManager fragmentManager = getSupportFragmentManager();\n    MyFragmentPagerAdapter pagerAdapter = new MyFragmentPagerAdapter(fragmentManager);\n    ViewPager viewPager = (ViewPager) findViewById(R.id.pager);\n    viewPager.setAdapter(pagerAdapter);\n  }\n}\n```\n\n## activity_main.xml\n\n```\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n  xmlns:tools=\"http://schemas.android.com/tools\"\n  android:layout_width=\"match_parent\"\n  android:layout_height=\"match_parent\"\n  android:orientation=\"vertical\"\n  tools:context=\"com.rakuishi.viewpagerfragment.sample.MainActivity\">\n\n  <android.support.v4.view.ViewPager\n    android:id=\"@+id/pager\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"0dp\"\n    android:layout_weight=\"1\"/>\n\n</LinearLayout>\n```\n\n## 実行結果\n\n左右にスワイプすることで複数のフラグメント間を行き来できます。\n\n![](/images/2014/06/6645_1.png)",
  "bodyHtml": "<p><code>FragmentPageAdapter</code> を使って、スワイプによるページ切り替えを実装してみます。動作は iOS でいう <code>UIScrollView</code> の <code>pagingEnabled</code> を有効にした時の挙動と同じです。</p>\n<h2>複数の Fragment をページ切り替えする</h2>\n<h2>MyFragment.java</h2>\n<p>まずは、ページ切り替えされるフラグメントを書きます。<code>Bundle</code> のデータを受け取り、その色を利用して背景色に設定します。</p>\n<pre><code>package com.rakuishi.viewpagerfragment.sample;\n\nimport android.support.v4.app.Fragment;\nimport android.graphics.Color;\nimport android.os.Bundle;\nimport android.view.LayoutInflater;\nimport android.view.View;\nimport android.view.ViewGroup;\n\npublic class MyFragment extends Fragment {\n\n  @Override\n  public View onCreateView(LayoutInflater inflater, ViewGroup container,\n               Bundle savedInstanceState) {\n    // Inflate the layout for this fragment\n    View view = inflater.inflate(R.layout.fragment_my, container, false);\n    if (getArguments() != null &amp;&amp; getArguments().containsKey(&quot;color&quot;)) {\n      view.setBackgroundColor(Color.parseColor(getArguments().getString(&quot;color&quot;)));\n    }\n    return view;\n  }\n}\n</code></pre>\n<h2>fragment_my.xml</h2>\n<pre><code>&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n  xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n  android:layout_width=&quot;match_parent&quot;\n  android:layout_height=&quot;match_parent&quot;\n  tools:context=&quot;com.rakuishi.viewpagerfragment.sample.MyFragment&quot;&gt;\n\n&lt;/FrameLayout&gt;\n</code></pre>\n<h2>MyFragmentPagerAdapter</h2>\n<p>次に切り替えを担う <code>[FragmentPagerAdapter](http://developer.android.com/reference/android/support/v4/app/FragmentPagerAdapter.html)</code> を継承した <code>MyFragmentPagerAdapter</code> を作ります。<code>FragmentPagerAdapter</code> は、v4 support library の機能ですので、これを導入しておく必要があります。→ <a href=\"http://rakuishi.com/archives/6609\">Android Studio で Support Library を導入する</a></p>\n<p><code>getCount()</code> と <code>getItem()</code> は必ず宣言する必要があり、その中でページ数とフラグメントを返します。</p>\n<pre><code>package com.rakuishi.viewpagerfragment.sample;\n\n// FragmentPagerAdapter は、Support Library から使える\nimport android.os.Bundle;\nimport android.support.v4.app.Fragment;\nimport android.support.v4.app.FragmentManager;\nimport android.support.v4.app.FragmentPagerAdapter;\n\npublic class MyFragmentPagerAdapter extends FragmentPagerAdapter {\n\n  public MyFragmentPagerAdapter(FragmentManager fragmentManager) {\n    super(fragmentManager);\n  }\n\n  @Override\n  public int getCount() {\n    return 3;\n  }\n\n  @Override\n  public Fragment getItem(int position) {\n\n    String color = &quot;#000000&quot;;\n    switch (position) {\n      case 0:\n        color = &quot;#FF0000&quot;;\n        break;\n      case 1:\n        color = &quot;#00FF00&quot;;\n        break;\n      case 2:\n        color = &quot;#0000FF&quot;;\n        break;\n    }\n    Bundle bundle = new Bundle();\n    bundle.putString(&quot;color&quot;, color);\n\n    Fragment fragment = new MyFragment();\n    fragment.setArguments(bundle);\n    return fragment;\n  }\n}\n</code></pre>\n<h2>MainActivity.java</h2>\n<p>アクティビティから <code>ViewPager</code> に先程の <code>MyFragmentPagerAdapter</code> をセットすることでページ切り替えが実装できます。先に v4 support library を使っているため、これに対応する <code>FragmentActivity</code> を継承するのがポイントです。</p>\n<pre><code>package com.rakuishi.viewpagerfragment.sample;\n\nimport android.os.Bundle;\nimport android.support.v4.app.FragmentActivity;\nimport android.support.v4.app.FragmentManager;\nimport android.support.v4.view.ViewPager;\n\npublic class MainActivity extends FragmentActivity {\n\n  @Override\n  protected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_main);\n\n    // getSupportFragmentManager は, FragmentActivity で使える\n    FragmentManager fragmentManager = getSupportFragmentManager();\n    MyFragmentPagerAdapter pagerAdapter = new MyFragmentPagerAdapter(fragmentManager);\n    ViewPager viewPager = (ViewPager) findViewById(R.id.pager);\n    viewPager.setAdapter(pagerAdapter);\n  }\n}\n</code></pre>\n<h2>activity_main.xml</h2>\n<pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;\n  xmlns:tools=&quot;http://schemas.android.com/tools&quot;\n  android:layout_width=&quot;match_parent&quot;\n  android:layout_height=&quot;match_parent&quot;\n  android:orientation=&quot;vertical&quot;\n  tools:context=&quot;com.rakuishi.viewpagerfragment.sample.MainActivity&quot;&gt;\n\n  &lt;android.support.v4.view.ViewPager\n    android:id=&quot;@+id/pager&quot;\n    android:layout_width=&quot;match_parent&quot;\n    android:layout_height=&quot;0dp&quot;\n    android:layout_weight=&quot;1&quot;/&gt;\n\n&lt;/LinearLayout&gt;\n</code></pre>\n<h2>実行結果</h2>\n<p>左右にスワイプすることで複数のフラグメント間を行き来できます。</p>\n<p><img src=\"/images/2014/06/6645_1.png\" alt=\"\"></p>\n",
  "dir": "static/content/archives",
  "base": "2014-06-18-6645.json",
  "ext": ".json",
  "sourceBase": "2014-06-18-6645.md",
  "sourceExt": ".md"
}